# JET (Journal Entry Testing) 工具重構專案

## 專案背景與目標

### 背景
目前事務所使用的 Journal Entry Testing Tool (JET) 依賴於 Caseware IDEA 軟體，並在其上開發 VBA 自定義功能，配合簡易的 Windows Forms 作為介面。由於 IDEA 授權即將到期且成本高昂，加上技術依賴性強，現在需要開發一個替代方案，以降低成本並提升使用彈性。

### 目標
- 開發一個更聚焦、更標準的工具，適應當前集中化的工作趨勢，提升整體效率
- 取代對 IDEA 工具的依賴，降低成本並增加技術彈性
- 優化審計流程，減少人工作業時間，提高準確性
- 透過工具改進，縮短服務時間或提升品質，進一步增強事務所的競爭力
- 提供 Excel/Access 架構的穩定解決方案，適用於 80% 以上的案件需求

## 技術選擇與架構

### 選定技術：Excel VBA + Access
- 可處理百萬筆資料，符合大多數審計案件需求
- 限制：Access 處理超過 6 萬筆資料可能變慢
- 避免依賴外部 SQL 環境，減少 IT 部門負擔
- 一般審計員更熟悉 Excel 介面，降低學習曲線

### 系統架構
- **前端**：Excel VBA (UserForms、Excel Worksheet)
- **後端**：Access 資料庫 (.accdb)
- **資料交互**：透過 DAO 或 ADO 後期綁定
- **分層設計**：
  - View 層：使用者介面表單
  - Controller 層：協調流程，處理 UI 事件
  - Service 層：業務邏輯與資料處理
  - Data Access 層：封裝資料庫操作

## 核心功能需求

### 1. 資料匯入與欄位映射
- 支援多種資料格式（CSV、TXT、XLSX）匯入
- 提供欄位映射機制，解決不同系統命名差異問題
- 自動化欄位對應，降低使用門檻
- 預覽資料表功能，確認欄位對應正確性

### 2. 科目標準化與配對
- 科目代碼與名稱標準化（Account Mapping）
- 將相同性質科目分組，便於篩選分析
- 科目配對歷史記錄，提高後續使用效率
- 提供標準科目定義表

### 3. 資料完整性驗證
- 試算表（TB）與分錄（GL）自動比對與驗證
- 借貸平衡測試
- 科目變動金額比對（考慮 1-3 與 4-7 開頭科目特性）
- 差異項目自動識別與追蹤

### 4. 高風險交易篩選功能
- 預設多種風險篩選條件（1-3個核心情境）
- 包含日期篩選（例如週末/假日）、金額篩選、編制人員篩選等
- 自定義篩選條件功能 (SQL查詢)
- 條件組合功能（AND/OR 邏輯）

### 5. 工作底稿自動生成
- 標準化 Excel 工作底稿自動產生
- 包含各步驟完整性測試結果
- 高風險分錄識別結果
- 符合審計工作要求的格式與內容

## 工作流程設計

### 步驟一：資料匯入與準備
1. 匯入原始資料（GL、TB）
2. 欄位映射與標準化
3. 資料預處理（格式統一、項次生成等）

### 步驟二：完整性測試
1. 試算表與分錄比對
2. 借貸平衡測試
3. 差異項目識別與分析
4. 差異調節建議

### 步驟三：科目配對與分類
1. 科目代碼與標準科目名稱配對
2. 科目分類與分組
3. 科目特性標記（例如資產、負債、收入等）

### 步驟四：高風險篩選條件設定
1. 預設篩選條件設置
2. 自定義篩選條件
3. 條件組合與優先順序設定

### 步驟五：結果分析與報告生成
1. 篩選結果預覽
2. 工作底稿自動生成
3. 差異說明與調節建議
4. 結果匯出與歸檔

## 開發與實施計畫

### 概念驗證 (POC) 階段
1. 核心功能開發與測試
   - 資料匯入與欄位映射功能
   - 完整性測試基本功能
   - 簡易篩選功能
   - 基本報告生成

2. 技術可行性評估
   - 大量資料處理性能測試
   - Access 資料庫效能評估
   - 使用者介面使用體驗評估

### 原型 (Prototype) 階段
1. 完整功能開發
   - 科目配對高級功能
   - 完整篩選條件實現
   - 工作底稿完整生成
   - 進階資料分析功能

2. 使用者測試與回饋
   - 內部審計人員測試
   - 使用體驗優化
   - 效率與準確性評估

### 全面部署階段
1. 完整解決方案打包
2. 用戶文檔與培訓材料編寫
3. 內部培訓與推廣
4. 持續改進機制建立

## Capstone 專案合作計畫

### 目標與範圍
1. 與大學合作開發 JET 工具原型
2. 學生參與測試與回饋，提供實際應用案例
3. 共同改進工具功能與使用體驗

### 具體合作方式
1. 學生參與角色
   - 參與測試，提供使用體驗回饋
   - 建立虛擬個案，測試工具發現錯誤的能力
   - 提供改進建議與創新想法

2. 課程策略
   - 提供"最低限度可行版本"(MVP)供學生測試
   - 分組討論，確保理解工具功能與應用
   - 技術說明與指導，確保開發順利

3. 預期成果
   - 成功開發基於 Excel/Access 的 JET 工具
   - 驗證工具的可行性與實際應用效果
   - 完整數據分析報告，展示效率提升與成本節省
   - 建立標準化開發框架，可用於未來專案

## EXCEL WorkingPaper 規格說明

### 工作表組成與內容

#### 1. 資料預處理說明
- 公司名稱與期間資訊
- JE Testing Tool 資料準備說明
- 相關文檔參考 (例如: OO_CAATS_JE_WP.docx)

#### 2. 工作底稿主要步驟與結構
- **Step1**: JE測試母體的完整性、借貸不平與分錄編制人員測試
- **Step2**: JE測試之攸關資料元素的可靠性測試
- **Step3**: 彙總已辨認之JE高風險範圍條件
- **Step4**: 測試符合JE高風險範圍條件之分錄
- **Step5**: 確認與測試財務報表關帳後調整之分錄

#### 3. 完整性測試 (Step1) 詳細內容
- 試算表科目與分錄借貸金額比對表格
- 借貸不平測試結果與說明
- 分錄編制人員清單與評估
- 差異項目說明與調節

#### 4. 可靠性測試 (Step2) 詳細內容
- 攸關資料元素 (RDE) 可靠性樣本測試
- 財務類型與非財務類型 RDE 測試結果
- 可靠性確認方法與結論

#### 5. 高風險範圍條件 (Step3) 詳細內容
- 風險評估程序說明
- 高風險條件定義與選擇理由
- 各條件篩選結果數量統計

#### 6. 高風險分錄測試 (Step4) 詳細內容
- 符合條件傳票清單
- 傳票測試結果與證據
- 測試結論與建議

#### 7. 關帳後調整分錄 (Step5) 詳細內容
- 關帳後調整分錄清單 (若有)
- 測試結果與說明

#### 8. 技術配置資訊
- 檔案欄位對照表
- 假期假日資訊表
- 科目配對資訊表
- 系統版本與設定資訊

### 資料表格欄位標準

#### 1. GL 資料表標準欄位
- 傳票號碼_JE (文字型態)
- 傳票文件項次_JE_S (數字型態)
- 總帳日期_JE (日期型態)
- 傳票建立人員_JE (文字型態)
- 傳票核准人員_JE (文字型態)
- 會計科目編號_JE (文字型態)
- 會計科目名稱_JE (文字型態)
- 傳票金額_JE (數字型態)
- 傳票摘要_JE (文字型態)

#### 2. TB 資料表標準欄位
- 會計科目編號_TB (文字型態)
- 會計科目名稱_TB (文字型態)
- 試算表變動金額_TB (數字型態)

#### 3. 科目配對資訊
- GL_NUMBER (原始科目代碼)
- GL_NAME (原始科目名稱)
- STANDARDIZED_ACCOUNT_NAME (標準化科目名稱)

## 專案技術注意事項

1. **資料量處理考量**
   - Excel 限制：單工作表最多 1,048,576 列
   - Access 性能：6萬筆以上可能變慢，需優化查詢
   - 大量資料案件 (>1000萬筆) 仍需考慮 IDEA 支援

2. **程式設計原則**
   - 模組化設計，確保各功能獨立
   - 錯誤處理完善，避免運行中斷
   - 狀態保存，防止步驟中斷需重新開始
   - 註解完整，便於維護與擴展

3. **使用者體驗優化**
   - 介面簡潔明瞭，減少操作步驟
   - 進度指示與錯誤提示清晰
   - 預覽功能，確保用戶理解操作結果
   - 操作記錄與復原功能

4. **未來擴展性考量**
   - 預留 AI 輔助分析整合接口
   - 架構設計適應更大資料量
   - 考慮雲端部署可能性
   - 開放式 API 設計，便於與其他系統整合

## 專案開發目標 (for Capstone)

1. 完整性的自動驗證功能 (TB vs GL)
2. Account mapping 的檢查功能
3. 核心篩選情境的開發 (5~7個)
4. 可自動產生 Excel results W/P
5. 可選(加分項)
   - 可於 Excel 運行的配套資料格式整理功能
   - 更多的篩選情境
   - 自動產生簡易的資料分析圖表